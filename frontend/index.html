<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Card Finder</title>
</head>
<body>

<h1>Hello World</h1>

<form id="card-form" method="post" action="/api/card">
    <label for="card-name"> Card Name
        <input id="card-name" type="text" name="name" />
    </label>
    <button type="submit">submit</button>

</form>

<script>
    const card = document.getElementById("card-name")
    const form = document.getElementById("card-form");
    form.addEventListener('submit', (e)=> {
        e.preventDefault()

        getCardNames(card.value)
    })

    let timer;
    card.addEventListener('keyup', (e) => {
        clearTimeout(timer)

        timer = setTimeout(()=> {
            getCardNames(e.target.value)
        }, 500)

    });

    const getCardNames = async (name) => {
        if (name === "") {
            return;
        }

        const options = {
            method: "POST",
        }

        const params = new URLSearchParams();
        params.append('name', name)

        const url = '/api/card?' + params.toString();

        const names = await fetch(url)
            .then(res => res.json())
            .then(data => console.log(data))
            .catch(err => console.log(err))
    }


</script>

</body>
</html>